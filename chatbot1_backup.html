<!DOCTYPE html>
<html lang="en">
<head>
	<title>convForm - example</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
	<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="dist/jquery.convform.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="demo.css">
	<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
	<link rel="stylesheet" href="/resources/demos/style.css">
	<style>
		#chatV {
			color: #ffffff;
			opacity: 0;
		}
		.dropbtn {
    background-color: #3498DB;
    color: white;
    padding: 16px;
    font-size: 16px;
    border: none;
    cursor: pointer;
}

.dropbtn:hover, .dropbtn:focus {
    background-color: #2980B9;
}

.dropdown {
    position: relative;
    display: inline-block;
}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #f1f1f1;
    min-width: 160px;
    overflow: auto;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
}

.dropdown-content div {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
}

.dropdown div:hover {background-color: #ddd}

.show {display:block;}
.tr {
    display:table-row; 
}
    </style>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script>
        $( function() {
            $('[achbereich]').selectmenu();
        }
    </script>
    <script>
/* When the user clicks on the button, 
toggle between hiding and showing the dropdown content */
function myFunction() {
    document.getElementById("myDropdown").classList.toggle("show");
}

// Close the dropdown if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {

    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
</script>
</head>
<body>
	<p id="chatV">1</p>
	<section id="demo">
	    <div class="vertical-align">
	        <div class="container">
	            <div class="row">
	                <div class="col-sm-6 col-sm-offset-3 col-xs-offset-0">
	                    <div class="card no-border">
	                        <div id="chat" class="conv-form-wrapper">
	                            <form action="" method="GET" class="hidden">
	                                <select name="fachbereich" data-callback="storeState" data-conv-question="Hallo! Ich bin dein Chatbot Assistent und kann dir dabei helfen das für dich beste Thema für deine Masterarbeit zu finden. Dafür brauche ich ein paar Informationen von dir:
Was ist dein Fachbereich?">
	                                    <option value="IW">Ingenieurwissenschaften</option>
	                                    <option value="WW">Wirtschaftswissenschaften</option>
	                                    <option value="NW">Naturwissenschaften</option>
	                                    <option value="INF">Informatik</option>
	                                    <option value="weitere">Weitere Fächer</option>
	                                </select>
	                                <div data-conv-fork="fachbereich">
	                                    <div data-conv-case="IW">
											<select name="studiengang" data-conv-question="Was ist dein Studiengang?">
												<option value="MB">Maschinenbau</option>
												<option value="V-PT">Verfahrens/Produktionstechnik</option>
												<option value="WerkWiss">Werkstoffwissenschaften</option>
												<option value="ET">Elektrotechnik</option>
												<option value="FT">Fahrzeugtechnik</option>
												<option value="L-RT">Luft- und Raumfahrttechnik</option>
												<option value="WIng">Wirtschaftsingenieurwesen</option>
												<option value="AT">Automatisierungstechnik</option>
												<option value="U-ET">Umwelt- und Energietechnik</option>
												<option value="weitere IW">Weitere Ingenieurwissenschaften</option>
											</select>
										</div>
										<div data-conv-case="WW">
											<select name="studiengang" data-conv-question="Was ist dein Studiengang?">
												<option value="BWL">Betriebswirtschaft</option>
												<option value="Fin">Finanzen</option>
												<option value="Log">Logistik</option>
												<option value="Mark">Marketing</option>
												<option value="PW">Personalwesen</option>
												<option value="VWL">Volkswirtschaftslehre</option>
												<option value="WInf">Wirtschaftsinformatik</option>
											</select>
										</div>
										<div data-conv-case="NW">
											<select name="studiengang" data-conv-question="Was ist dein Studiengang?">
												<option value="PHY">Physik</option>
												<option value="MAT">Mathematik</option>
												<option value="CHE">Chemie</option>
												<option value="BIO">Biologie</option>
												<option value="weitere NW">Weitere Naturwissenschaften</option>
											</select>
										</div>
										<div data-conv-case="INF">
											<select name="studiengang" data-conv-question="Was ist dein Studiengang?">
												<option value="WINF">Wirtschaftsinformatik</option>
												<option value="TINF">Technische Informatik</option>
												<option value="INFT">Informationstechnik</option>
												<option value="KINF">Kommunikationsinformatik</option>
												<option value="weitere INF">Weitere Informatik</option>
											</select>
										</div>
										<div data-conv-case="weitere">
											<select name="studiengang" data-conv-question="Was ist dein Studiengang?">
												<option value="PSY">Psychologie</option>
												<option value="MWISS">Medienwissenschaften</option>
												<option value="KWISS">Kommunikationswissenschaften</option>
												<option value="SWISS">Sozialwissenschaften</option>
												<option value="weitere Studienrichtungen">Weitere Studienrichtungen</option>
											</select>
										</div>
									</div>
									<select name="bundesland" data-conv-question="In welchem Bundesland soll das Unternehmen sein?">
										<option value="NRW">Nordrhein-Westfalen</option>
										<option value="BY">Bayern</option>
										<option value="BW">Baden-Württemberg</option>
										<option value="HE">Hessen</option>
										<option value="NI">Niedersachsen</option>
										<option value="RP">Rheinland-Pfalz</option>
										<option value="BE">Berlin</option>
										<option value="SN">Sachsen</option>
										<option value="HH">Hamburg</option>
										<option value="SH">Schleswig-Holstein</option>
										<option value="BB">Brandenburg</option>
										<option value="TH">Thüringen</option>
										<option value="ST">Sachsen-Anhalt</option>
										<option value="MV">Mecklenburg-Vorpommern</option>
										<option value="SL">Saarland</option>
										<option value="HB">Bremen</option>
									</select>
									<input type="text" data-conv-question="Super - Ich habe bereits interessante Themen für dich gefunden." data-no-answer="true">
									<input type="text" data-conv-question="Die nun kommende Frage handelt darüber, ob du dich für unseren Newsletter anmelden willst." data-no-answer="true">
									<select name="publishMail" data-callback="storeState" data-conv-question="Möchtest du dich für unseren Newsletter anmelden?">
										<option value="ja">Ja</option>
										<option value="nein">Nein</option>
									</select>
									<div data-conv-fork="publishMail">
										<div data-conv-case="ja">
											<input type="text" data-conv-question="Wenn du möchtest nenne mir deine E-Mail Adresse und ich registriere dich für unseren Newsletter mit aktuellen Themen zu deinen Angaben." data-pattern="^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$" id="email" type="email" name="email" required placeholder="Deine E-Mail (optional)">
										</div>
										<div data-conv-case="nein">
										</div>
									</div>
	                            </form>
	                        </div>
	                    </div>
	                </div>
	            </div>
	        </div>
	    </div>
	</section>
	<script type="text/javascript" src="jquery-1.12.3.min.js"></script>
	<script type="text/javascript" src="dist/autosize.min.js"></script>
	<script type="text/javascript" src="dist/jquery.convform.js"></script>

	<script>
		function google() {
			window.open("https://google.com");
		}
		function bing() {
			window.open("https://bing.com");
		}
		var rollbackTo = false;
		var originalState = false;
		function storeState(stateWrapper) {
			rollbackTo = stateWrapper.current;
			console.log("storeState called: ",rollbackTo);
		}
		function rollback(stateWrapper) {
			console.log("rollback called: ", rollbackTo, originalState);
			console.log("answers at the time of user input: ", stateWrapper.answers);
			if(rollbackTo!=false) {
				if(originalState==false) {
					originalState = stateWrapper.current.next;
						console.log('stored original state');
				}
				stateWrapper.current.next = rollbackTo;
				console.log('changed current.next to rollbackTo');
			}
		}
		function restore(stateWrapper) {
			if(originalState != false) {
				stateWrapper.current.next = originalState;
				console.log('changed current.next to originalState');
			}
		}
	</script>
	<script>
		$(document).ready(function(){
			var data = window.location.search;
			data = new URLSearchParams(window.location.search);
			if (data != "") {
				console.log("data: " + data);
				console.log(data.get("fachbereich"));
				console.log(data.get("studiengang"));
				console.log(data.get("bundesland"));
				console.log(data.get("email"));
				var fachbereich = data.get("fachbereich");
				var studiengang = data.get("studiengang");
				var bundesland = data.get("bundesland");
				var email = data.get("email");
				var chatV = $('#chatV').text();
				console.log(chatV);
				var submitString = "fach=" + fachbereich + "&stud=" + studiengang + "&bund=" + bundesland + "&em=" + email + "&chatV=" + chatV;
				var surveyString =  "http://umfragen.ise.tu-darmstadt.de/sosci/chat/?";
				var URL = surveyString + submitString;
				console.log(URL);
				window.location = URL;
			}
		});
		</script>
</body>
</html>
